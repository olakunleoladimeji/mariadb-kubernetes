[maxscale]
threads=auto
substitute_variables=true

[Galera Monitor]
type=monitor
module=galeramon
servers=server1,server2,server3
user=root
passwd=$MYSQL_PASS
monitor_interval=10000
disable_master_failback=1

[qla]
type=filter
module=qlafilter
filebase=/tmp/SqlQueryLog

[fetch]
type=filter
module=regexfilter
match=fetch
replace=select

[RW]
type=service
router=readwritesplit
servers=server1,server2,server3
user=root
passwd=$MYSQL_PASS
max_slave_connections=100%
router_options=slave_selection_criteria=LEAST_CURRENT_OPERATIONS

[RR]
type=service
router=readconnroute
router_options=synced
servers=server1,server2,server3
user=root
passwd=$MYSQL_PASS

[Debug Interface]
type=service
router=debugcli

[CLI]
type=service
router=cli

[RWlistener]
type=listener
service=RW
protocol=mariadbclient
address=maxscale
port=3307

[RRlistener]
type=listener
service=RR
protocol=mariadbclient
address=maxscale
port=3308

[Debug Listener]
type=listener
service=Debug Interface
protocol=telnetd
address=127.0.0.1
port=4442

[CLI Listener]
type=listener
service=CLI
protocol=maxscaled
address=127.0.0.1
port=6603


[server1]
type=server
address=galera-0
port=3306
protocol=mariadbbackend

[server2]
type=server
address=galera-1
port=3306
protocol=mariadbbackend

[server3]
type=server
address=galera-2
port=3306
protocol=mariadbbackend
